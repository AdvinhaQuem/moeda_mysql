CREATE DATABASE `moeda-estudantil` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;

CREATE TABLE `aluno` (
  `IDALUNO` int NOT NULL AUTO_INCREMENT,
  `MATRICULAALUNO` int unsigned NOT NULL,
  `CPFALUNO` varchar(11) NOT NULL,
  `NOME` varchar(50) NOT NULL,
  `MOEDAS` int DEFAULT NULL,
  `CNPJUNIVERSIDADE` varchar(14) NOT NULL,
  `SENHA` varchar(64) NOT NULL,
  PRIMARY KEY (`IDALUNO`),
  UNIQUE KEY `MATRICULA_ALUNO_UNIQUE` (`MATRICULAALUNO`),
  UNIQUE KEY `IDALUNO_UNIQUE` (`IDALUNO`),
  KEY `CNPJUNIVERSIDADE_FK_idx` (`CNPJUNIVERSIDADE`),
  CONSTRAINT `CNPJUNIVERSIDADE_FK` FOREIGN KEY (`CNPJUNIVERSIDADE`) REFERENCES `universidade` (`CNPJ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `professor` (
  `IDPROFESSOR` int unsigned NOT NULL AUTO_INCREMENT,
  `MATRICULAPROFESSOR` int unsigned NOT NULL,
  `CPFPROFESSOR` varchar(11) NOT NULL,
  `NOME` varchar(50) NOT NULL,
  `MOEDAS` int DEFAULT NULL,
  `CNPJUNIVERSIDADE` varchar(14) NOT NULL,
  `SENHA` varchar(64) NOT NULL,
  PRIMARY KEY (`IDPROFESSOR`),
  UNIQUE KEY `IDPROFESSOR_UNIQUE` (`IDPROFESSOR`),
  UNIQUE KEY `MATRICULAPROFESSOR_UNIQUE` (`MATRICULAPROFESSOR`),
  KEY `CNPJUNIVERSIDADE_FK_idx` (`CNPJUNIVERSIDADE`),
  CONSTRAINT `CNPJU_FK` FOREIGN KEY (`CNPJUNIVERSIDADE`) REFERENCES `universidade` (`CNPJ`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `transfaluno` (
  `IDTRANSFERENCIA` int NOT NULL,
  `IDALUNOREMETENTE` int DEFAULT NULL,
  `IDALUNODESTINATARIO` int DEFAULT NULL,
  `QUANTMOEDAS` int unsigned DEFAULT NULL,
  `MENSAGEM` varchar(500) DEFAULT NULL,
  `DATA` date DEFAULT NULL,
  `CONFIRMLEITURA` bit(1) DEFAULT NULL,
  PRIMARY KEY (`IDTRANSFERENCIA`),
  UNIQUE KEY `IDTRANSFERENCIA_UNIQUE` (`IDTRANSFERENCIA`),
  KEY `IDALUNOREMETENTE_idx` (`IDALUNOREMETENTE`),
  KEY `IDALUNODESTINATARIO_idx` (`IDALUNODESTINATARIO`),
  CONSTRAINT `IDALUNODESTINATARIO` FOREIGN KEY (`IDALUNODESTINATARIO`) REFERENCES `aluno` (`IDALUNO`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `IDALUNOREMETENTE_FK` FOREIGN KEY (`IDALUNOREMETENTE`) REFERENCES `aluno` (`IDALUNO`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


CREATE TABLE `transfprofessor` (
  `IDTRANSFERENCIA` int NOT NULL,
  `IDPROFESSORR` int unsigned DEFAULT NULL,
  `IDALUNOD` int unsigned DEFAULT NULL,
  `QUANTMOEDAS` int unsigned DEFAULT NULL,
  `MENSAGEM` varchar(500) DEFAULT NULL,
  `DATA` date DEFAULT NULL,
  `CONFIRM_LEITURA` bit(1) DEFAULT NULL,
  PRIMARY KEY (`IDTRANSFERENCIA`),
  UNIQUE KEY `IDTRANSFERENCIA_UNIQUE` (`IDTRANSFERENCIA`),
  KEY `IDPROFESSORREMETENTE_FK_idx` (`IDPROFESSORR`),
  KEY `IDALUNODESTINATARIO_FK_idx` (`IDALUNOD`),
  CONSTRAINT `IDALUNOD_FK` FOREIGN KEY (`IDALUNOD`) REFERENCES `aluno` (`MATRICULAALUNO`),
  CONSTRAINT `IDPROFESSORR_FK` FOREIGN KEY (`IDPROFESSORR`) REFERENCES `professor` (`IDPROFESSOR`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

CREATE TABLE `universidade` (
  `RAZAO_SOCIAL` varchar(100) NOT NULL,
  `IDUNIVERSIDADE` int unsigned NOT NULL AUTO_INCREMENT,
  `CNPJ` varchar(14) NOT NULL,
  PRIMARY KEY (`IDUNIVERSIDADE`),
  UNIQUE KEY `CNPJ_UNIQUE` (`CNPJ`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


